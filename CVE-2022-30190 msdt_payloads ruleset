/* MSDT payloads CVE-2022-30190*/

rule msdt_payloads
{
  meta:
    name = "CVE-2022-30190"
    author = "Rohan Kumar"
    desc = "Detect paylaods that use the MSDT"
    
  strings:
    $required1 = "ms-msdt:/id"
    $required2 = "IT_LaunchMethod=ContextMenu"
    $required3 = "/../../"
    
    $option1 = "window.location.href"
    $option2 = "location.href" 
    
  condition:
    ( $required1 and $required2 and $required3) and ( $option1 or $option2)
}
